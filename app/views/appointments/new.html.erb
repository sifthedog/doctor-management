<% flash.each do |type, msg| %>
  <% if type == "alert" %>
      <div class="alert alert-danger text-center">
  <% else %>
      <div class="alert alert-success text-center">
  <% end %>
  <%= msg %>
  </div>
<% end %>

<div class='container'>
    <%= form_with scope: :appointment, url: appointments_path, local: true do |form| %>
        <div class="card mt-5">
          <h3 class="card__border p-3">
            Agendamento de Consulta:
          </h3>

          <div class="d-flex p-3">
            <div class="input-group">
              <div class="input-group-prepend flex-fill mr-2">
                <span class="input-group-text" id="basic-addon1">Médico:</span>
                <%= select_tag(
                    'doctor_id', 
                    options_for_select(
                      @doctors.map {|doctor| [doctor.name, doctor.id]}
                    ), 
                    class: "form-control"
                  ) 
                %>
              </div>
            </div>
            <div class="input-group">
              <div class="input-group-prepend flex-fill">
                <span class="input-group-text" id="basic-addon1">Paciente:</span>
                <%= select_tag(
                  'patient_id', 
                  options_for_select(
                    @patients.map {|patient| [patient.name, patient.id]}
                  ),
                  class: "form-control"
                  ) 
                %>
              </div>
            </div> 
          </div>
          <div class="d-flex p-3 card__border">
            <div class="input-group mr-2">
              <div class="input-group-prepend flex-fill">
                <span class="input-group-text form-control" id="basic-addon1">Data:</span>
                <%= form.date_select :starts_at, 
                  {
                    start_year: Date.today.year, 
                    end_year: (Date.today + 1.year).year, 
                    order: [:day, :month, :year]
                  }, 
                  {
                    class: "form-control"
                  } 
                %>
              </div>
            </div>
            <div class="input-group">
              <span class="input-group-text" id="basic-addon1">Horário:</span>
              <%= select_tag(
                'starts_at(4i)', 
                options_for_select(
                  ([(9..11)].map {|x| x.map { |y| y }}).first + ([(13..17)].map {|x| x.map { |y| y }}).first
                ), 
                class: "form-control") 
              %>
              <%= select_tag(
                'starts_at(5i)', 
                options_for_select(
                  ['00', '30']
                ), 
                class: "form-control") 
              %>
            </div>
          </div>
          <div class="d-flex flex-row-reverse p-3">
            <%= form.submit "Agendar Consulta", :class => "btn btn-primary" %>
            <%= link_to "Voltar", appointments_path, :method => :get, :class => "btn mr-3" %>
          </div>
        </div>
      </div>
    <% end %>
</div>